    <div class="user-profile">
        <div class="user-avatar-large" id="modal-user-avatar">U</div>
        <div class="user-info-modal">
            <h2 id="modal-user-name">Загрузка...</h2>
            <p id="modal-user-channel">Telegram</p>
        </div>
    </div>
    
    <div class="stats-grid">
        <div class="stat-item">
            <div class="stat-number" id="modal-total-messages">0</div>
            <div class="stat-label">Всего сообщений</div>
        </div>
        <div class="stat-item">
            <div class="stat-number" id="modal-incoming-messages">0</div>
            <div class="stat-label">Входящих</div>
        </div>
        <div class="stat-item">
            <div class="stat-number" id="modal-outgoing-messages">0</div>
            <div class="stat-label">Исходящих</div>
        </div>
    </div>
    
    <div class="info-section">
        <h3>Информация</h3>
        <div class="info-item">
            <span class="info-item-label">ID пользователя:</span>
            <span class="info-item-value" id="modal-user-id">-</span>
        </div>ч
        <div class="info-item">
            <span class="info-item-label">Внешний ID:</span>
            <span class="info-item-value" id="modal-external-id">-</span>
        </div>
        <div class="info-item">
            <span class="info-item-label">Назначен:</span>
            <span class="info-item-value" id="modal-assigned-to">Не назначен</span>
        </div>
        <div class="info-item" style="flex-direction: column; align-items: flex-start;">
            <span class="info-item-label">Кластеры:</span>
            <div id="selected-clusters" style="margin: 10px 0; min-height: 30px;"></div>
            <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                <button type="button" onclick="toggleCluster('VIP')" class="cluster-btn" data-cluster="VIP" style="padding: 5px 10px; border: 1px solid #007bff; background: white; color: #007bff; border-radius: 15px; cursor: pointer; font-size: 12px;">VIP</button>
                <button type="button" onclick="toggleCluster('Постоянный')" class="cluster-btn" data-cluster="Постоянный" style="padding: 5px 10px; border: 1px solid #28a745; background: white; color: #28a745; border-radius: 15px; cursor: pointer; font-size: 12px;">Постоянный</button>
                <button type="button" onclick="toggleCluster('Новый')" class="cluster-btn" data-cluster="Новый" style="padding: 5px 10px; border: 1px solid #17a2b8; background: white; color: #17a2b8; border-radius: 15px; cursor: pointer; font-size: 12px;">Новый</button>
                <button type="button" onclick="toggleCluster('Проблемный')" class="cluster-btn" data-cluster="Проблемный" style="padding: 5px 10px; border: 1px solid #dc3545; background: white; color: #dc3545; border-radius: 15px; cursor: pointer; font-size: 12px;">Проблемный</button>
                <button type="button" onclick="toggleCluster('Активный')" class="cluster-btn" data-cluster="Активный" style="padding: 5px 10px; border: 1px solid #ffc107; background: white; color: #ffc107; border-radius: 15px; cursor: pointer; font-size: 12px;">Активный</button>
            </div>
        </div>
        <div class="info-item">
            <span class="info-item-label">Дата создания:</span>
            <span class="info-item-value" id="modal-created-at">-</span>
        </div>
    </div>
    
    <div class="info-section">
        <h3>Комментарий</h3>
        <textarea id="modal-user-comment" placeholder="Добавьте комментарий к пользователю..." style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"></textarea>
        <button onclick="saveClientData()" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Сохранить данные</button>
    </div>
    
    <script>
    let selectedClusters = [];
    
    function toggleCluster(cluster) {
        const index = selectedClusters.indexOf(cluster);
        const btn = document.querySelector(`[data-cluster="${cluster}"]`);
        
        if (index > -1) {
            selectedClusters.splice(index, 1);
            btn.style.background = 'white';
            btn.style.color = btn.style.borderColor;
        } else {
            selectedClusters.push(cluster);
            btn.style.background = btn.style.borderColor;
            btn.style.color = 'white';
        }
        
        updateSelectedClusters();
    }
    
    function updateSelectedClusters() {
        const container = document.getElementById('selected-clusters');
        if (selectedClusters.length === 0) {
            container.innerHTML = '<span style="color: #6c757d; font-size: 12px;">Кластеры не выбраны</span>';
        } else {
            const colors = {
                'VIP': '#007bff',
                'Постоянный': '#28a745',
                'Новый': '#17a2b8',
                'Проблемный': '#dc3545',
                'Активный': '#ffc107'
            };
            
            container.innerHTML = selectedClusters.map(cluster => 
                `<span style="background: ${colors[cluster]}; color: white; padding: 3px 8px; border-radius: 10px; font-size: 11px; margin-right: 5px; margin-bottom: 3px; display: inline-block;">${cluster}</span>`
            ).join('');
        }
    }
    
    function setClientClusters(clusters) {
        selectedClusters = clusters || [];
        
        // Сбрасываем все кнопки
        document.querySelectorAll('.cluster-btn').forEach(btn => {
            btn.style.background = 'white';
            btn.style.color = btn.style.borderColor;
        });
        
        // Активируем выбранные
        selectedClusters.forEach(cluster => {
            const btn = document.querySelector(`[data-cluster="${cluster}"]`);
            if (btn) {
                btn.style.background = btn.style.borderColor;
                btn.style.color = 'white';
            }
        });
        
        updateSelectedClusters();
    }
    
    function getSelectedClusters() {
        return selectedClusters;
    }
    </script>